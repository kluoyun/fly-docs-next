---
sidebar_position: 1
---

# Введение
Модуль давления ALPS является решением для датчика давления на основе ADS131M02, разработанным специально для автоматической установки Z-оси (Home) и выравнивания платы печати с помощью сетки в 3D-принтерах. С помощью высокочувствительного детектирования давления и обработки сигналов в реальном времени, модуль может точно определять контактное состояние сопла с рабочей поверхностью, обеспечивая точность выравнивания до миллиметрового уровня, устраняя ошибки механической калибровки и значительно повышая успешность первого слоя печати.
# Сравнение параметров
<ImageView image={require('@site/docs/ProductDoc/ExtensionBoard/fly-alps/img/csdb.webp').default} size="100%" align="center" />

## Использование модуля давления APLS

### Рекомендуемое использование функции протирки сопла
При использовании модуля давления APLS рекомендуется использовать функцию протирки сопла, чтобы гарантировать чистоту сопла, что способствует повышению точности и стабильности калибровки.

#### Схема подключения 4Pin XH2.54
Модуль может быть напрямую подсоединен к материнской плате через UART или подключен к расширительной плате через UART. Если UART-порт отсутствует, найдите два вывода на материнской плате, учитывая полярность соединения.
<ImageView image={require('@site/docs/ProductDoc/ExtensionBoard/fly-alps/img/uart1.webp').default} size="100%" align="center" />
<ImageView image={require('@site/docs/ProductDoc/ExtensionBoard/fly-alps/img/uart.webp').default} size="100%" align="center" />

### Примечания при установке
1. Убедитесь, что модуль установлен надежно, чтобы избежать проблем с контактом из-за вибрации во время печати.
2. Проверьте правильность подключения проводов, чтобы избежать неполадок работы модуля из-за ошибок подключения.
3. Перед первым использованием рекомендуется выполнить несколько тестов калибровки, чтобы убедиться, что чувствительность и точность модуля соответствуют ожиданиям.

## Отображение индикатора состояния
- **Включенное состояние**: Зеленый и красный индикаторы горят постоянно, указывая на нормальную работу модуля.
- **Триггерное состояние**: Красный индикатор мигает, указывая на активацию модуля.
<ImageView image={require('@site/docs/ProductDoc/ExtensionBoard/fly-alps/img/LED.webp').default} size="20%" align="center" />

### Диагностика неисправностей индикатора
- Если индикатор не загорается, проверьте правильность подключения питания.
- Если индикатор продолжает мигать, возможно, модуль обнаружил аномальные сигналы. Проверьте, не застрял ли зонд или не поврежден ли он посторонним предметом.

## Руководство по настройке
Замените существующие настройки файла конфигурации для `probe` и `home` следующими настройками:

### Пример файла конфигурации
Следующее содержимое файла конфигурации рекомендуется, его следует адаптировать под конкретные потребности:


```cfg
[homing_override]
axes: xyz
set_position_z:10
gcode:
       G91
       G1 Z10 F3000
       G90
        SET_PIN PIN=_probe_ready VALUE=0
        ## _LIFT_Z
       {% set home_all = 'X' not in params and 'Y' not in params and 'Z' not in params %}

       {% if home_all or 'X' in params %}
            G28 X
       {% endif %}

       {% if home_all or 'Y' in params %}
            G28 Y
            G0 X{printer.toolhead.axis_maximum.x / 2} Y{printer.toolhead.axis_maximum.y / 2} F6000
       {% endif %}

       {% if home_all or 'Z' in params %}
       # Если используется Eddy вместе с датчиком давления, раскомментируйте нижнюю строку
            #SET_PIN PIN=_probe_ready VALUE=1 
            G28 Z 
            #SET_PIN PIN=_probe_ready VALUE=0
            G1 Z10 F3000           
        {% endif %}

[output_pin _probe_ready]
pin: PA9 #En #Пин активации
shutdown_value: 0
value:0

[probe]
pin: ^PA10 #out #Пин датчика
x_offset: 0                  # Смещение по оси X относительно сопла
y_offset: 0               # Смещение по оси Y относительно сопла
z_offset:0                # Смещение по оси Z относительно сопла
speed: 8                 # Скорость калибровки
samples: 3                   # Количество выборок
samples_result: median       # Метод выбора значения (по умолчанию - медиана)
sample_retract_dist: 2     # Выдвижная дистанция для калибровки
samples_tolerance: 0.05      # Толеранс выборки (слишком маленькие значения могут увеличить количество выборок)
samples_tolerance_retries: 3 # Количество попыток перезапуска при превышении толеранса
activate_gcode:
           G4 P500
           SET_PIN PIN=_probe_ready VALUE=1
deactivate_gcode:
           SET_PIN PIN=_probe_ready VALUE=0  

```

### Справка по корректировке значения z-offset
Используйте эту команду для настройки z-offset:
```gcode
PROBE_CALIBRATE
```

- Перед корректировкой значения `z-offset` ознакомьтесь с руководством Klipper по методу «Paper Test»: [Paper Test](https://www.klipper3d.org/Bed_Level.html#the-paper-test)

:::info Важно
- Если модуль давления используется как концевой выключатель Z-оси, замените настройку `endstop_pin` на: `endstop_pin: probe:z_virtual_endstop`
:::
